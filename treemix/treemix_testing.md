# Testing for treemix

# Compare treemix inputs

generate the input file of treemix with **stacks** and compare it with **scalepopgen** generated input

## Files to be used for testing

chr1\_filt\_samples\_filt\_sites.vcf.gz : https://data.cyverse.org/dav-anon/iplant/home/maulik88/chr1_filt_samples_filt_sites.vcf.gz
sample_pop.map : https://data.cyverse.org/dav-anon/iplant/home/maulik88/sample_pop.map

## Commands used for testing
```
time python3 vcf_to_treemix.py -v chr1_filt_samples_filt_sites.vcf.gz -m sample_pop.map -o chr1_scale -O t

real	9m12,664s
user	9m11,581s
sys	0m0,108s

time populations -V chr1_filt_samples_filt_sites.vcf.gz -M sample_pop.map --treemix -O .
real	14m31,736s
user	12m2,198s
sys	2m27,176s

gzip chr1_treemixIn.txt

gzip chr1_filt_samples_filt_sites.p.treemix

treemix -i chr1_filt_samples_filt_sites.p.treemix.gz -k 500 -seed 1234 -root Wenshan_Cattle -o stacks

treemix -i chr1_treemixIn.txt.gz -k 500 -seed 1234 -root Wenshan_Cattle -o scalepopgen

```
## Concluding remarks
Both the input files generate the exact tree (including the exact same branch length)

## Why write the custom python script for transformation instead of using _populations_?
1). _populations_ generates an extensive outputs such as (other population-based summary statistics) along with treemix input file. 
2). The treemix input file generated by _populations_ also contains extra comment about the software version--> need an extra step to remove it

